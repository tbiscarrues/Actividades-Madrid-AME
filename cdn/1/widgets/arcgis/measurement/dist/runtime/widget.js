System.register(["jimu-core","jimu-arcgis","jimu-ui","jimu-theme"],(function(e,t){var a={},s={},n={},i={};return{setters:[function(e){a.AppMode=e.AppMode,a.React=e.React,a.ReactRedux=e.ReactRedux,a.WidgetState=e.WidgetState,a.appActions=e.appActions,a.classNames=e.classNames,a.css=e.css,a.getAppStore=e.getAppStore,a.hooks=e.hooks,a.jsx=e.jsx,a.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules},function(e){s.JimuMapViewComponent=e.JimuMapViewComponent},function(e){n.Button=e.Button,n.Icon=e.Icon,n.Loading=e.Loading,n.LoadingType=e.LoadingType,n.Popper=e.Popper,n.Select=e.Select,n.WidgetPlaceholder=e.WidgetPlaceholder,n.defaultMessages=e.defaultMessages},function(e){i.Global=e.Global,i.useTheme=e.useTheme}],execute:function(){e((()=>{var e={86604:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" fill-rule="evenodd" d="M4 17.062.5 11l15.589-9 3.5 6.062zm-2.134-5.696 13.856-8 2.5 4.33-1.299.75-1-1.732-.866.5 1 1.732-1.732 1-1-1.732-.866.5 1 1.732-1.732 1-1.5-2.598-.866.5 1.5 2.598-1.732 1-1-1.732-.866.5 1 1.732-1.732 1-1-1.732-.866.5 1 1.732-1.299.75z" clip-rule="evenodd"></path></svg>'},9044:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M6 6.5a.5.5 0 0 1 1 0v6a.5.5 0 0 1-1 0zM9.5 6a.5.5 0 0 0-.5.5v6a.5.5 0 0 0 1 0v-6a.5.5 0 0 0-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M11 0H5a1 1 0 0 0-1 1v2H.5a.5.5 0 0 0 0 1h1.6l.81 11.1a1 1 0 0 0 .995.9h8.19a1 1 0 0 0 .995-.9L13.9 4h1.6a.5.5 0 0 0 0-1H12V1a1 1 0 0 0-1-1m0 3V1H5v2zm1.895 1h-9.79l.8 11h8.19z" clip-rule="evenodd"></path></svg>'},62686:e=>{"use strict";e.exports=s},79244:e=>{"use strict";e.exports=a},1888:e=>{"use strict";e.exports=i},14321:e=>{"use strict";e.exports=n}},t={};function r(a){var s=t[a];if(void 0!==s)return s.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="";var l={};return r.p=window.jimuConfig.baseUrl,(()=>{"use strict";r.r(l),r.d(l,{__set_webpack_public_path__:()=>k,default:()=>j});var e,t=r(79244),a=r(62686),s=r(14321);!function(e){e.Classic="CLASSIC",e.Toolbar="TOOLBAR"}(e||(e={}));const n=[{key:"unitsLabelMetric",value:"metric"},{key:"unitsLabelImperial",value:"imperial"}];var i=r(9044),o=r.n(i),u=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(a[s[n]]=e[s[n]])}return a};const c=e=>{const a=window.SVG,{className:s}=e,n=u(e,["className"]),i=(0,t.classNames)("jimu-icon jimu-icon-component",s);return a?t.React.createElement(a,Object.assign({className:i,src:o()},n)):t.React.createElement("svg",Object.assign({className:i},n))},d=[...n,{key:"unitsInches",value:"inches"},{key:"unitsLabelFeet",value:"feet"},{key:"unitsLabelYards",value:"yards"},{key:"unitsLabelMiles",value:"miles"},{key:"unitsLabelNauticalMiles",value:"nautical-miles"},{key:"unitsLabelFeetUS",value:"us-feet"},{key:"unitsLabelMeters",value:"meters"},{key:"unitsLabelKilometers",value:"kilometers"}],m=[...n,{key:"unitsLabelSquareInches",value:"square-inches"},{key:"unitsLabelSquareFeet",value:"square-feet"},{key:"unitsLabelSquareYards",value:"square-yards"},{key:"unitsLabelSquareMiles",value:"square-miles"},{key:"unitsLabelSquareFeetUS",value:"square-us-feet"},{key:"unitsLabelSquareMeters",value:"square-meters"},{key:"unitsLabelSquareKilometers",value:"square-kilometers"},{key:"unitsLabelAcres",value:"acres"},{key:"unitsLabelAres",value:"ares"},{key:"unitsLabelHectares",value:"hectares"}],v=t.css`
&.measure-toolbar {
  height: 40px;
  .measure-tools {
    height: 24px;
    .measure-tool {
      border-radius: var(--sys-shape-1) !important;
      &.active {
        color: var(--sys-color-action-selected-text);
        background-color: var(--sys-color-action-selected);
      }
    }
  }
  .measure-unit-clear {
    height: 24px;
    flex-grow: 1;
    border-left: 1px solid var(--sys-color-secondary-main);
    .measure-unit {
      flex-grow: 1;
    }
  }
}
`,p=t.React.forwardRef(((a,n)=>{const{config:i,context:r,activeButton:l,translate:o,onSelectTool:u,onChangeUnit:p,onClear:g}=a,{enableDistance:f=!0,defaultDistanceUnit:b="metric",enableArea:y=!0,defaultAreaUnit:h="metric",arrangement:x=e.Classic}=i,[w,R]=t.React.useState(b),[M,S]=t.React.useState(h);t.React.useEffect((()=>{"measureDistance"===l&&R(b),"measureArea"===l&&S(h)}),[l,h,b]);const j=t.React.useCallback((e=>{R(e.target.value),p(e.target.value)}),[p]),k=t.React.useCallback((e=>{S(e.target.value),p(e.target.value)}),[p]),A=x===e.Toolbar,C=[{name:"measureDistance",icon:`${r.folderUrl}dist/runtime/assets/measure-distance.svg`,enabled:f},{name:"measureArea",icon:`${r.folderUrl}dist/runtime/assets/measure-area.svg`,enabled:y}];return(0,t.jsx)("div",{ref:n,className:"measure-toolbar d-flex justify-content-between p-2",css:v},(0,t.jsx)("div",{className:"measure-tools d-flex"},C.filter((e=>e.enabled)).map((e=>(0,t.jsx)(s.Button,{key:e.name,icon:!0,type:"tertiary",className:(0,t.classNames)("measure-tool p-0 mr-1",{active:l===e.name}),onClick:()=>{u(e)},"aria-label":o(e.name)},(0,t.jsx)(s.Icon,{className:"m-0",icon:e.icon}))))),A&&(0,t.jsx)("div",{className:"measure-unit-clear d-flex align-items-center"},"measureDistance"===l&&f&&(0,t.jsx)(s.Select,{size:"sm",value:w,className:"measure-unit ml-1",onChange:j,"aria-label":o("defaultUnit")},d.map((e=>(0,t.jsx)("option",{key:e.key,value:e.value},o(e.key))))),"measureArea"===l&&y&&(0,t.jsx)(s.Select,{size:"sm",value:M,className:"measure-unit ml-1",onChange:k,"aria-label":o("defaultUnit")},m.map((e=>(0,t.jsx)("option",{key:e.key,value:e.value},o(e.key))))),""===l&&(0,t.jsx)(s.Select,{size:"sm",value:"measureUnit",disabled:!0,className:"measure-unit ml-1"},(0,t.jsx)("option",{value:"measureUnit"},o("measureUnit"))),(0,t.jsx)(s.Button,{icon:!0,type:"tertiary",className:"p-0 ml-1",disabled:""===l,onClick:g,"aria-label":o("clearMeasurement")},(0,t.jsx)(c,{className:"m-0"}))))}));var g=r(1888);const f=e=>{var t,a,s,n,i,r,l,o,u,c,d,m,v,p,g;return`\n  --calcite-color-text-inverse: ${null===(i=null===(n=null===(s=null===(a=null===(t=e.components)||void 0===t?void 0:t.button)||void 0===a?void 0:a.variants)||void 0===s?void 0:s.primary)||void 0===n?void 0:n.default)||void 0===i?void 0:i.color} !important;\n  --calcite-color-brand: ${null===(c=null===(u=null===(o=null===(l=null===(r=e.components)||void 0===r?void 0:r.button)||void 0===l?void 0:l.variants)||void 0===o?void 0:o.primary)||void 0===u?void 0:u.default)||void 0===c?void 0:c.bg} !important;\n  --calcite-color-brand-hover: ${null===(g=null===(p=null===(v=null===(m=null===(d=e.components)||void 0===d?void 0:d.button)||void 0===m?void 0:m.variants)||void 0===v?void 0:v.primary)||void 0===p?void 0:p.hover)||void 0===g?void 0:g.bg} !important;\n`},b=(e,a)=>t.css`
&.measure-panel {
  border-top: 1px solid var(--sys-color-divider-primary);
  overflow: auto;
  .measure-clear {
    padding: 0 15px 12px 15px;
    button {
      width: 100%;
      height: 32px;
    }
  }
  .esri-widget {
    background-color: transparent !important;
  }
  ${f(e)}
  ${["disabled","ready"].includes(a)?t.css`
    height: calc(100% - 42px);
    .esri-widget--panel {
      height: 100%;
      .esri-measurement-widget-content {
        height: 100%;
        .esri-measurement-widget-content__hint {
          height: 100%;
          display: grid;
          place-items: center;
          text-align: center;
        }
      }
    }`:""}
}
`,y={rootBoundary:"viewport",padding:0},h={fallbackPlacements:["top-start"]};function x(a){const{id:n,config:i,activeButton:r,jimuMapView:l,activeTool:o,setActiveTool:u,rootRef:c,translate:d,onClear:m}=a,{defaultDistanceUnit:v="metric",defaultAreaUnit:p="metric",arrangement:x=e.Classic}=i,[w,R]=t.React.useState(!1),[M,S]=t.React.useState(null);t.React.useEffect((()=>{R(!0),(0,t.loadArcGISJSAPIModules)(["esri/widgets/DistanceMeasurement2D","esri/widgets/AreaMeasurement2D","esri/widgets/DirectLineMeasurement3D","esri/widgets/AreaMeasurement3D","esri/core/reactiveUtils"]).then((e=>{const[t,a,s,n,i]=e;S({DistanceMeasurement2D:t,AreaMeasurement2D:a,DirectLineMeasurement3D:s,AreaMeasurement3D:n,reactiveUtils:i}),R(!1)}))}),[]);const j=t.React.useRef(null),k=t.React.useRef(null),A=t.React.useRef({}),C=t.React.useRef(null);t.React.useEffect((()=>{Object.values(A.current).forEach((e=>{e.measureDistance&&(e.measureDistance.viewModel.unit=v),e.measureArea&&(e.measureArea.viewModel.unit=p)}))}),[v,p]);const L=x===e.Toolbar,D=L?k:j,[N,I]=t.React.useState("disabled"),O=t.hooks.useLatest(l);t.React.useEffect((()=>{var e,t,a,s;const i=O.current;if(!(null==i?void 0:i.view)||!D.current||!M)return;const l=o;"object"==typeof(null==l?void 0:l.container)&&null!==(null==l?void 0:l.container)&&(l.container.style.visibility="hidden",l.container.style.height="0",l.container.style.overflow="hidden");const d=null===(e=null==l?void 0:l.viewModel)||void 0===e?void 0:e.state;let m,g;["ready","measuring"].includes(d)&&l.viewModel.clear(),C.current&&(null===(a=null===(t=C.current)||void 0===t?void 0:t.remove)||void 0===a||a.call(t),C.current=null);const{DistanceMeasurement2D:f,AreaMeasurement2D:b,DirectLineMeasurement3D:y,AreaMeasurement3D:h,reactiveUtils:x}=M,w=A.current[i.id]||(A.current[i.id]={});if("measureDistance"===r)m="2d"===i.view.type?f:y,g=v;else{if("measureArea"!==r)return void I("disabled");m="2d"===i.view.type?b:h,g=p}w[r]||m&&g&&(w[r]=new m({id:`${n}-${i.id}-${r}`,container:document.createElement("div"),view:i.view,unit:g,visible:!0}));const R=w[r];u(R),"object"==typeof(null==R?void 0:R.container)&&null!==(null==R?void 0:R.container)&&(R.container.style.visibility="visible",R.container.style.height="",R.container.style.overflow="");const S=null===(s=null==R?void 0:R.viewModel)||void 0===s?void 0:s.state;I(S||"disabled"),"measured"!==S&&R&&R.viewModel.start(),R&&(D.current.prepend(R.container),C.current=x.watch((()=>{var e;return null===(e=null==R?void 0:R.viewModel)||void 0===e?void 0:e.state}),(e=>{if(I(e||"disabled"),"ready"===e&&"2d"===i.view.type&&"snappingOptions"in R){const e={enabled:!0,selfEnabled:!0,gridEnabled:!0,featureEnabled:!0,featureSources:i.getSnappingLayers().map((e=>({enabled:!0,layer:e})))};R.snappingOptions=e}}),{initial:!0})),c.current&&k.current&&(k.current.style.width=c.current.offsetWidth+"px")}),[n,r,O,D,o,u,c,v,p,M]);const T=t.React.useMemo((()=>{var e;return null===(e=null==l?void 0:l.isClickHighlightEnabled)||void 0===e?void 0:e.call(l)}),[l]);t.React.useEffect((()=>{T&&(["ready","measuring"].includes(N)?l.disableClickHighlight():l.enableClickHighlight())}),[l,N,T]);const U=t.ReactRedux.useSelector((e=>e.appRuntimeInfo.appMode===t.AppMode.Design)),_=t.ReactRedux.useSelector((e=>e.appRuntimeInfo.currentPageId)),E=_!==t.React.useRef(_).current,P=t.React.useCallback((()=>{Object.values(A.current).forEach((e=>{var t,a,s,n;null===(a=null===(t=e.measureDistance)||void 0===t?void 0:t.destroy)||void 0===a||a.call(t),e.measureDistance=null,null===(n=null===(s=e.measureArea)||void 0===s?void 0:s.destroy)||void 0===n||n.call(s),e.measureArea=null}))}),[]),q=t.ReactRedux.useSelector((e=>e.appContext.isInBuilder));t.hooks.useUpdateEffect((()=>{q&&(P(),I("disabled"))}),[l,x,q]),t.React.useEffect((()=>()=>{P(),u(null)}),[P,u]);const B=(0,g.useTheme)();return(0,t.jsx)(t.React.Fragment,null,w&&(0,t.jsx)(s.Loading,{type:s.LoadingType.Secondary}),!w&&!L&&(0,t.jsx)("div",{ref:j,className:"measure-panel",css:b(B,N)},""===r&&(0,t.jsx)("div",{"aria-label":d("selectToStart"),className:"esri-widget esri-widget--panel",role:"presentation"},(0,t.jsx)("div",{className:"esri-measurement-widget-content"},(0,t.jsx)("section",{className:"esri-measurement-widget-content__hint"},(0,t.jsx)("p",{className:"esri-measurement-widget-content__hint-text"},d("selectToStart"))))),""!==r&&["measuring","measured"].includes(N)&&(0,t.jsx)("div",{className:"measure-clear"},(0,t.jsx)(s.Button,{type:"secondary",onClick:m,"aria-label":d("clearMeasurement")},d("clearMeasurement")))),!w&&L&&!U&&(0,t.jsx)(s.Popper,{className:(0,t.classNames)("surface-1",{"d-none":E}),reference:c.current,placement:"bottom-start",open:""!==r,keepMount:!0,shiftOptions:y,flipOptions:h,offsetOptions:5},(0,t.jsx)("div",{ref:k,className:"measure-popper"}),(0,t.jsx)(g.Global,{styles:t.css`
        .measure-popper {
          .esri-widget {
            background-color: transparent !important;
          }
          .esri-measurement-widget-content__settings {
            display: ${L?"none":"block"};
          }
          ${f(B)}
        }
      `})))}const w={_widgetLabel:"Measurement",selectToStart:"Select a tool to start measure.",measureDistance:"Measure distance",measureArea:"Measure area",clearMeasurement:"Clear measurement",measureUnit:"Measure unit"};var R=r(86604),M=r.n(R);const S=t.css`
  min-width: 270px;
  min-height: 40px;
  height: 100%;
  overflow: auto;
`;const j=function(n){const{id:i,useMapWidgetIds:r,context:l,config:o}=n,{enableDistance:u=!0,enableArea:c=!0,arrangement:d=e.Classic}=o,m=null==r?void 0:r[0],[v,g]=t.React.useState(null),[f,b]=t.React.useState(!0),y=t.React.useCallback((()=>{b(!1)}),[]),[h,R]=t.React.useState(""),j=t.ReactRedux.useSelector((e=>e.appRuntimeInfo.appMode===t.AppMode.Design)),k=t.ReactRedux.useSelector((e=>e.widgetsRuntimeInfo[i].state===t.WidgetState.Closed));t.React.useEffect((()=>{R("")}),[j,u,c,d,k,r,v]);const A=t.ReactRedux.useSelector((e=>{var t;return(null===(t=e.mapWidgetsInfo[m])||void 0===t?void 0:t.autoControlWidgetId)===i}));t.React.useEffect((()=>{A||R("")}),[A]);const C=t.React.useRef(null),[L,D]=t.React.useState(null),N=t.React.useCallback((e=>{L&&(L.unit=e)}),[L]),I=t.React.useCallback((()=>{L&&L.viewModel.clear()}),[L]),O=m&&(u||c),T=t.hooks.useTranslation(s.defaultMessages,w);return(0,t.jsx)("div",{id:i,className:"widget-measurement h-100 surface-1 border-0",css:S},!O&&(0,t.jsx)("div",{className:"w-100 h-100"},(0,t.jsx)(s.WidgetPlaceholder,{className:"w-100 placeholder-wrapper",icon:M(),widgetId:n.id,message:T("_widgetLabel")})),O&&(0,t.jsx)(t.React.Fragment,null,(0,t.jsx)("div",{className:(0,t.classNames)("h-100",{"d-none":f})},(0,t.jsx)(p,{ref:C,config:o,context:l,activeButton:h,activeTool:L,translate:T,onSelectTool:e=>{if(e.name===h){R("");const e=t.appActions.releaseAutoControlMapWidget(m);(0,t.getAppStore)().dispatch(e)}else{R(e.name);const a=t.appActions.requestAutoControlMapWidget(m,i);(0,t.getAppStore)().dispatch(a)}},onChangeUnit:N,onClear:I}),(0,t.jsx)(x,{id:i,config:o,jimuMapView:v,activeButton:h,activeTool:L,setActiveTool:D,rootRef:C,translate:T,onClear:I})),(0,t.jsx)(a.JimuMapViewComponent,{useMapWidgetId:m,onViewsCreate:y,onActiveViewChange:g}),m&&f&&(0,t.jsx)(s.Loading,{type:s.LoadingType.Secondary})))};function k(e){r.p=e}})(),l})())}}}));