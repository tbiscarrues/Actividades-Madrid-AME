System.register(["jimu-core","jimu-theme","jimu-ui","jimu-for-builder","jimu-ui/advanced/setting-components","jimu-ui/basic/list-tree","jimu-arcgis","jimu-ui/advanced/map","esri/analysis/SlicePlane","esri/analysis/SliceAnalysis","esri/Viewpoint","esri/core/reactiveUtils"],(function(e,t){var a={},n={},i={},o={},l={},s={},r={},c={},d={},u={},g={},m={};return{setters:[function(e){a.APP_FRAME_NAME_IN_BUILDER=e.APP_FRAME_NAME_IN_BUILDER,a.Immutable=e.Immutable,a.LayoutType=e.LayoutType,a.React=e.React,a.ReactRedux=e.ReactRedux,a.classNames=e.classNames,a.css=e.css,a.getAppStore=e.getAppStore,a.hooks=e.hooks,a.jsx=e.jsx,a.polished=e.polished},function(e){n.useTheme=e.useTheme},function(e){i.Button=e.Button,i.FloatingPanel=e.FloatingPanel,i.Icon=e.Icon,i.Label=e.Label,i.NumericInput=e.NumericInput,i.Radio=e.Radio,i.Select=e.Select,i.Switch=e.Switch,i.defaultMessages=e.defaultMessages},function(e){o.getAppConfigAction=e.getAppConfigAction},function(e){l.DirectionSelector=e.DirectionSelector,l.MapWidgetSelector=e.MapWidgetSelector,l.SettingCollapse=e.SettingCollapse,l.SettingRow=e.SettingRow,l.SettingSection=e.SettingSection,l.SidePopper=e.SidePopper},function(e){s.List=e.List,s.TreeItemActionType=e.TreeItemActionType},function(e){r.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules},function(e){c.JimuMap=e.JimuMap},function(e){d.default=e.default},function(e){u.default=e.default},function(e){g.default=e.default},function(e){m.whenOnce=e.whenOnce}],execute:function(){e((()=>{var e={31027:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5c0 .527-.074 1.036-.212 1.518l.912.438a6.5 6.5 0 1 0-6.586 4.533l-.077-1.008A5.5 5.5 0 1 1 12 6.5m-9 0a3.5 3.5 0 0 0 2.88 3.445L5.8 8.901a2.501 2.501 0 1 1 3.194-2.224l.949.456A3.5 3.5 0 1 0 3 6.5M15.5 11l-5 1-3 4-1-9.5zm-5.57.094-1.702 2.269-.542-5.152 4.76 2.38z" clip-rule="evenodd"></path></svg>'},93303:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M9.438.994c.213 0 .397.146.44.35q.227 1.084.316 1.852.562.242 1.048.599l1.728-.676a.455.455 0 0 1 .556.188l1.42 2.394a.43.43 0 0 1-.091.547 22 22 0 0 1-1.49 1.194q.03.27.03.552 0 .32-.038.63l1.465 1.12a.43.43 0 0 1 .111.563l-1.42 2.394a.454.454 0 0 1-.53.197 23 23 0 0 1-1.807-.66q-.49.35-1.055.586l-.263 1.794a.446.446 0 0 1-.445.376H6.574a.446.446 0 0 1-.44-.35 21 21 0 0 1-.317-1.853 5.3 5.3 0 0 1-1.047-.598l-1.728.675a.455.455 0 0 1-.556-.187l-1.42-2.395a.43.43 0 0 1 .091-.546q.85-.735 1.49-1.194a5.167 5.167 0 0 1 .008-1.183L1.19 6.243a.43.43 0 0 1-.112-.562l1.42-2.395a.455.455 0 0 1 .531-.196q1.078.35 1.807.66c.324-.233.679-.43 1.056-.587l.262-1.794A.446.446 0 0 1 6.6.994zm-.365 1H6.985l-.28 1.866-.467.19q-.353.144-.672.34l-.207.136-.42.293-.476-.197q-.492-.205-1.169-.433l-.221-.074-1.045 1.719L3.59 6.999l-.06.479a4 4 0 0 0-.021.816l.014.144.058.492-.419.294q-.433.304-.979.746l-.177.145 1.043 1.72 1.845-.703.406.29q.307.219.645.384l.228.103.474.199.059.49q.06.507.19 1.177l.043.219h2.088l.282-1.867.466-.19q.354-.144.672-.34l.207-.136.419-.293.476.198q.495.204 1.17.433l.22.072 1.044-1.718-1.56-1.165.06-.479a4 4 0 0 0 .02-.815l-.013-.144-.06-.492.42-.295a18 18 0 0 0 .98-.746l.176-.146-1.043-1.72-1.844.705-.406-.29a4.5 4.5 0 0 0-.646-.385l-.228-.103-.474-.199-.058-.49q-.049-.405-.14-.916zm-1.067 3a3 3 0 1 1 0 6 3 3 0 0 1 0-6m0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4" clip-rule="evenodd"></path></svg>'},12046:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M11.227 1.312c-.404-.404-1.045-.417-1.432-.03L2.49 8.587l-.48 2.674a.637.637 0 0 0 .73.73l2.673-.48 7.305-7.306c.387-.387.374-1.028-.03-1.431zm-8.114 9.575.32-1.781 4.991-4.992 1.462 1.462-4.992 4.991zm7.473-6.012 1.402-1.4-1.462-1.463-1.401 1.402z" clip-rule="evenodd"></path><path fill="#000" d="M1.5 14a.5.5 0 0 0 0 1h13a.5.5 0 0 0 0-1z"></path></svg>'},28996:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 2.125 14.334 14H1.667zm-.882-.47a1 1 0 0 1 1.765 0l6.333 11.874A1 1 0 0 1 14.334 15H1.667a1 1 0 0 1-.882-1.47zM8 4.874a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0L8.9 5.87a.905.905 0 0 0-.9-.995m1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd"></path></svg>'},5739:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTIiIGhlaWdodD0iNTYiIHZpZXdCb3g9IjAgMCA5MiA1NiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxyZWN0IHdpZHRoPSI5MiIgaGVpZ2h0PSI1NiIgZmlsbD0iIzI4MjgyOCIvPg0KPGNpcmNsZSBjeD0iMTQiIGN5PSIxNCIgcj0iNSIgZmlsbD0iIzZBNkE2QSIvPg0KPGNpcmNsZSBjeD0iMTQiIGN5PSIyOCIgcj0iNSIgZmlsbD0iIzZBNkE2QSIvPg0KPGNpcmNsZSBjeD0iMTQiIGN5PSI0MiIgcj0iNSIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMjYiIHk9IjEyIiB3aWR0aD0iMjciIGhlaWdodD0iNCIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMjYiIHk9IjI2IiB3aWR0aD0iNDIiIGhlaWdodD0iNCIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMjYiIHk9IjQwIiB3aWR0aD0iNTMiIGhlaWdodD0iNCIgZmlsbD0iIzZBNkE2QSIvPg0KPC9zdmc+DQo="},91130:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA4IiBoZWlnaHQ9IjcyIiB2aWV3Qm94PSIwIDAgMTA4IDcyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHJlY3QgeD0iMjMiIHk9IjI2IiB3aWR0aD0iNjIiIGhlaWdodD0iMjAiIGZpbGw9IiMyODI4MjgiLz4NCjxyZWN0IHg9IjMyIiB5PSIzMCIgd2lkdGg9IjEyIiBoZWlnaHQ9IjEyIiByeD0iNiIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iNDgiIHk9IjMwIiB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHJ4PSI2IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI2NCIgeT0iMzAiIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgcng9IjYiIGZpbGw9IiM2QTZBNkEiLz4NCjwvc3ZnPg0K"},54948:e=>{"use strict";e.exports=g},11526:e=>{"use strict";e.exports=u},5338:e=>{"use strict";e.exports=d},62243:e=>{"use strict";e.exports=m},62686:e=>{"use strict";e.exports=r},79244:e=>{"use strict";e.exports=a},4108:e=>{"use strict";e.exports=o},1888:e=>{"use strict";e.exports=n},14321:e=>{"use strict";e.exports=i},48993:e=>{"use strict";e.exports=c},79298:e=>{"use strict";e.exports=l},98640:e=>{"use strict";e.exports=s}},t={};function p(a){var n=t[a];if(void 0!==n)return n.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,p),i.exports}p.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return p.d(t,{a:t}),t},p.d=(e,t)=>{for(var a in t)p.o(t,a)&&!p.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},p.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),p.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},p.p="";var f={};return p.p=window.jimuConfig.baseUrl,(()=>{"use strict";p.r(f),p.d(f,{__set_webpack_public_path__:()=>ae,default:()=>te});var e=p(79244),t=p(1888),a=p(14321),n=p(4108),i=p(79298);const o={arrangementStyle:"Arrangement style",activedOnLoad:"Active tool when widget load",timezoneSelector:"Timezone selector",timeSliderSteps:"Time slider steps",dateSelector:"Date selector",defaultSeason:"Default season",syncedWithMap:"Synchronized with map",spring:"Spring",summer:"Summer",fall:"Fall",winter:"Winter",autoYearlyPlay:"Auto yearly play",daytimePlaySpeed:"Daytime play speed",shadowOption:"Shadow option",dateTimeOption:"Date time option",defaultWeather:"Default weather",sunny:"Sunny",cloudy:"Cloudy",rainy:"Rainy",snowy:"Snowy",foggy:"Foggy",defaultValues:"Default values",cloudCover:"Cloud cover",precipitation:"Precipitation",sunnyDay:"Sunny day",cloudyDay:"Cloudy day",rainyDay:"Rainy day",snowyDay:"Snowy day",snowCover:"Snow cover",foggyDay:"Foggy day",fogStrength:"Fog density",defaultAnalysisType:"Default analysis type",threshold:"Above threshold",duration:"Total duration",discreteShadow:"Discrete shadow",colorSchema:"Color schema",observePoint:"Observe Point",markIntersections:"Mark Intersections",markPoint:"Mark Point",excludeGroundSurface:"Allow excluding ground",tiltEnabled:"Allow slice place tilt",defaultSlice:"Default slice",setDefaultSlice:"Set default slice",savePopper:"Save",savedState:"Saved",yesBtn:"Yes",closePopper:"Close",confirmInfo:"You have unsaved changes, do you want to close?"};function l(t){const a=t.ref.palette.neutral[300];return e.css`
      font-size: 13px;
      font-weight: lighter;

      .jimu-widget-setting--section {
        padding: 18px 16px;
      }

      /* ToolsContainer */
      .jimu-tree {
        .jimu-tree-item {
          .jimu-tree-item__content {
            .jimu-tree-item__body {
              background-color: transparent;

              .jimu-tree-item__title-text {
                /* for Safari ,#9889 */
                -webkit-line-clamp: 1;
                word-break: keep-all;
              }
            }
          }
        }
      }

      /* Arrangement ui-mode */
      .ui-mode-setting {
        display: flex;
      }

      .ui-mode-card-chooser{
        display: flex;
        align-items: start;

        .ui-mode-card-wapper {
          width: calc((100% - ${10}px - ${8}px) / 2);
        }

        .ui-mode-card-separator {
          width: ${10}px
        }
        .ui-mode-card {
          flex: 1;
          width: 100%;
          background: ${a};
          border: ${2}px solid ${a};
          margin: 0 0 0.5rem 0;

          .jimu-icon {
            margin: 0
          }
        }
        .ui-mode-card.active {
          border: ${2}px solid #00D8ED;
          background-color: ${a} !important;
        }
        .ui-mode-label {
          overflow: hidden;
          text-align: center;
        }
      }

      .placeholder-container{
        height: calc(100% - 180px);

        .placeholder-icon{
          color: var(--ref-palette-neutral-800);
        }
        .placeholder-hint{
          font-size: ${e.polished.rem(14)};
          font-weight: 500;
          color: var(--ref-palette-neutral-1000);
          max-width: ${e.polished.rem(160)};
        }
      }
  `}var s,r,c,d,u,g,m;!function(e){e.Daylight="daylight",e.Weather="weather",e.ShadowCast="shadowcast",e.LineOfSight="lineofsight",e.Slice="slice"}(s||(s={})),function(e){e.Date="date",e.Season="season"}(r||(r={})),function(e){e.SyncedWithMap="syncedWithMap",e.Spring="spring",e.Summer="summer",e.Fall="fall",e.Winter="winter"}(c||(c={})),function(e){e.Sunny="sunny",e.Cloudy="cloudy",e.Rainy="rainy",e.Snowy="snowy",e.Foggy="foggy"}(d||(d={})),function(e){e.Threshold="threshold",e.Duration="duration",e.Discrete="discrete"}(u||(u={})),function(e){e.List="list",e.Icon="icon"}(g||(g={})),function(e){e.Horizontal="horizontal",e.Vertical="vertical"}(m||(m={}));var h=p(98640),S=p(93303),y=p.n(S);const x=e.React.memo((t=>{const n=e.hooks.useTranslation(o,a.defaultMessages),l=t.onSidePopperToggle,r=e.React.useCallback(((e,t)=>{l(e.id,t.event.target)}),[l]),c=e.React.useCallback((e=>(null==e?void 0:e.map((e=>{const t=e.enable,a=[{label:n("edit"),iconProps:()=>({icon:y()}),action:t=>{r(e,t)}}];return{itemKey:e.id,itemStateTitle:n(e.id),itemStateChecked:t,itemStateCommands:e.id!==s.LineOfSight?a:[]}}))).asMutable()),[r,n]),[d,u]=e.React.useState((()=>c(t.tools)));return e.React.useEffect((()=>{u(c(t.tools))}),[t.tools,c]),(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SettingSection,{title:n("tools"),role:"group","aria-label":n("tools")},(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"w-100"},(0,e.jsx)(h.List,{className:"w-100 py-1 pl-0 pr-1",itemsJson:d,isMultiSelection:!0,dndEnabled:!0,disableDoubleClickTitle:!0,onUpdateItem:(a,n)=>{const[,i]=a.itemJsons,o=[...i],l=[];a.updateType===h.TreeItemActionType.HandleCheckboxChanged?t.tools.forEach((e=>{o.forEach((t=>{const a=t.itemKey;e.id===a&&(e=e.setIn(["enable"],t.itemStateChecked),l.push(e))}))})):a.updateType===h.TreeItemActionType.HandleDidDrop&&o.forEach((e=>{const a=e.itemKey,n=t.tools.findIndex((e=>e.id===a));n>-1&&l.push(t.tools[n])})),t.onToolsConfigChanged((0,e.Immutable)(l))}})))))}));function C(t){return e.css`
    .side-popper-container{
      padding-top: 0;

      .side-popper {
        .numeric-input {
          width: 56px; /* ,#10453 */
        }

        .first-setting-section {
          padding-top: 0;
        }

        .jimu-widget-setting--section {
          padding-left: 0;
          padding-right: 0;
        }
      }

      /* Shadow cast */
      .shadow-cast-radios {
        color: ${t.ref.palette.neutral[1100]}
      }
    }
  `}const j=e.React.memo((t=>{const n=e.hooks.useTranslation(o,a.defaultMessages),l=t.onAcitvedChanged,s=e.React.useCallback((e=>{l(e)}),[l]);return(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SettingSection,null,(0,e.jsx)(i.SettingRow,{tag:"label",label:n("activedOnLoad")},(0,e.jsx)(a.Switch,{checked:t.toolConfig.activedOnLoad,onChange:e=>{s(e.target.checked)}}))))})),v=e.React.memo((t=>{const n=e.hooks.useTranslation(o,a.defaultMessages),l=e.React.useMemo((()=>({timeSliderStepsDefault:5,timeSliderStepsMax:120,timeSliderStepsMin:1,speedDefault:1,speedMax:10,speedMin:.1})),[]),{onSettingChanged:s,hanldeToolSettingChanged:d}=t,u=t.toolConfig.config,g=e.React.useCallback(((e,a)=>{s(d(t.toolConfig,e,a))}),[t.toolConfig,s,d]),m=e.React.useCallback(((e,t)=>{t&&g({dateOrSeason:e})}),[g]),p=e.React.useCallback((e=>{let t={playButtons:e};!e&&u.dateTimeAutoPlay&&(t=Object.assign(Object.assign({},t),{dateTimeAutoPlay:!1})),g(t)}),[g,u.dateTimeAutoPlay]),f=[c.SyncedWithMap,c.Spring,c.Summer,c.Fall,c.Winter];return(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SettingSection,{className:"first-setting-section"},(0,e.jsx)(i.SettingRow,{tag:"label",label:n("timezoneSelector")},(0,e.jsx)(a.Switch,{checked:u.timezone,onChange:e=>{g({timezone:e.target.checked})}})),(0,e.jsx)(i.SettingRow,{label:n("timeSliderSteps")},(0,e.jsx)(a.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:u.timeSliderSteps,defaultValue:l.timeSliderStepsDefault,min:l.timeSliderStepsMin,max:l.timeSliderStepsMax,step:1,precision:0,onChange:e=>{g({timeSliderSteps:e})},required:!0,"aria-label":n("timeSliderSteps")})),(0,e.jsx)(i.SettingRow,{tag:"label",label:n("dateSelector")},(0,e.jsx)(a.Switch,{checked:u.datePicker,onChange:e=>{g({datePicker:e.target.checked})}})),u.datePicker&&(0,e.jsx)(i.SettingRow,{role:"group","aria-label":n("dateSelector")},(0,e.jsx)("div",{className:"d-block"},(0,e.jsx)("div",{className:"d-flex align-items-center mb-2"},(0,e.jsx)(a.Label,{className:"d-flex align-items-center"},(0,e.jsx)(a.Radio,{name:"dateOrSeason",className:"mr-2",checked:u.dateOrSeason===r.Date,onChange:(e,t)=>{m(r.Date,t)}}),n("date"))),(0,e.jsx)("div",{className:"d-flex align-items-center"},(0,e.jsx)(a.Label,{className:"d-flex align-items-center"},(0,e.jsx)(a.Radio,{name:"dateOrSeason",className:"mr-2",checked:u.dateOrSeason===r.Season,onChange:(e,t)=>{m(r.Season,t)}}),n("season"))))),u.dateOrSeason===r.Season&&(0,e.jsx)("div",{role:"group","aria-label":n("defaultSeason"),className:"my-4"},(0,e.jsx)(i.SettingRow,{label:n("defaultSeason")}),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(a.Select,{size:"sm",value:u.currentSeason,onChange:e=>{g({currentSeason:e.target.value})},className:""},f.map(((t,a)=>{const i=n(t);return(0,e.jsx)("option",{key:a,value:t},i)}))))),(0,e.jsx)(i.SettingRow,{tag:"label",label:n("enablePlayControl")},(0,e.jsx)(a.Switch,{checked:u.playButtons,onChange:e=>{p(e.target.checked)}})),u.playButtons&&u.dateOrSeason===r.Date&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SettingRow,{tag:"label",label:n("autoPlay")},(0,e.jsx)(a.Switch,{checked:u.dateTimeAutoPlay,onChange:e=>{g({dateTimeAutoPlay:e.target.checked})}})),(0,e.jsx)(i.SettingRow,{label:n("daytimePlaySpeed")},(0,e.jsx)(a.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:u.playSpeedMultiplier,defaultValue:l.speedDefault,min:l.speedMin,max:l.speedMax,step:.5,onChange:e=>{g({playSpeedMultiplier:e})},required:!0,"aria-label":n("daytimePlaySpeed")}))),(0,e.jsx)(i.SettingRow,{tag:"label",label:n("dateTimeOption")},(0,e.jsx)(a.Switch,{checked:u.dateTimeToggle,onChange:e=>{g({dateTimeToggle:e.target.checked})}})),(0,e.jsx)(i.SettingRow,{tag:"label",label:n("shadowOption")},(0,e.jsx)(a.Switch,{checked:u.isShowShadows,onChange:e=>{g({isShowShadows:e.target.checked})}}))),(0,e.jsx)(j,{toolConfig:t.toolConfig,onAcitvedChanged:e=>{g(null,e)}}))})),w=e.React.memo((t=>{const n=e.hooks.useTranslation(o,a.defaultMessages),{onSettingChanged:l,hanldeToolSettingChanged:s}=t,r=e.React.useCallback(((e,a)=>{l(s(t.toolConfig,e,a))}),[t.toolConfig,l,s]),[c,u]=e.React.useState(!1),g=()=>{u(!c)},[m,p]=e.React.useState(!1),f=()=>{p(!m)},[h,S]=e.React.useState(!1),y=()=>{S(!h)},[x,C]=e.React.useState(!1),v=()=>{C(!x)},[w,b]=e.React.useState(!1),I=()=>{b(!w)},R=[d.Sunny,d.Cloudy,d.Rainy,d.Snowy,d.Foggy],N=t.toolConfig.config;return(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SettingSection,{className:"first-setting-section",role:"group","aria-label":n("defaultWeather")},(0,e.jsx)(i.SettingRow,{label:n("defaultWeather")}),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(a.Select,{size:"sm",value:N.weatherType,onChange:e=>{r({weatherType:e.target.value})},className:""},R.map(((t,a)=>(0,e.jsx)("option",{key:a,value:t},n(t))))))),(0,e.jsx)(i.SettingSection,null,(0,e.jsx)(i.SettingRow,{label:n("defaultValues")}),(0,e.jsx)(i.SettingCollapse,{label:n("sunnyDay"),role:"group","aria-label":n("sunnyDay"),isOpen:c,onRequestOpen:g,onRequestClose:g,className:"my-4"},(0,e.jsx)(i.SettingRow,{label:n("cloudCover"),className:"mx-1 my-2"},(0,e.jsx)(a.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:N.sunnyConfig.cloudCover,defaultValue:.5,min:0,max:1,step:.1,onChange:e=>{r({sunnyConfig:{cloudCover:e}})},required:!0,"aria-label":n("cloudCover")}))),(0,e.jsx)(i.SettingCollapse,{label:n("cloudyDay"),role:"group","aria-label":n("cloudyDay"),isOpen:m,onRequestOpen:f,onRequestClose:f,className:"my-4"},(0,e.jsx)(i.SettingRow,{label:n("cloudCover"),className:"mx-1 my-2"},(0,e.jsx)(a.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:N.cloudyConfig.cloudCover,defaultValue:.5,min:0,max:1,step:.1,onChange:e=>{r({cloudyConfig:{cloudCover:e}})},required:!0,"aria-label":n("cloudCover")}))),(0,e.jsx)(i.SettingCollapse,{label:n("rainyDay"),role:"group","aria-label":n("rainyDay"),isOpen:h,onRequestOpen:y,onRequestClose:y,className:"my-4"},(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SettingRow,{label:n("cloudCover"),className:"mx-1 my-2"},(0,e.jsx)(a.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:N.rainyConfig.cloudCover,defaultValue:.5,min:0,max:1,step:.1,onChange:e=>{r({rainyConfig:Object.assign(Object.assign({},N.rainyConfig),{cloudCover:e})})},required:!0,"aria-label":n("cloudCover")})),(0,e.jsx)(i.SettingRow,{label:n("precipitation"),className:"mx-1 my-2"},(0,e.jsx)(a.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:N.rainyConfig.precipitation,defaultValue:.5,min:0,max:1,step:.1,onChange:e=>{r({rainyConfig:Object.assign(Object.assign({},N.rainyConfig),{precipitation:e})})},required:!0,"aria-label":n("precipitation")})))),(0,e.jsx)(i.SettingCollapse,{label:n("snowyDay"),role:"group","aria-label":n("snowyDay"),isOpen:x,onRequestOpen:v,onRequestClose:v,className:"my-4"},(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SettingRow,{label:n("cloudCover"),className:"mx-1 my-2"},(0,e.jsx)(a.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:N.snowyConfig.cloudCover,defaultValue:.5,min:0,max:1,step:.1,onChange:e=>{r({snowyConfig:Object.assign(Object.assign({},N.snowyConfig),{cloudCover:e})})},required:!0,"aria-label":n("cloudCover")})),(0,e.jsx)(i.SettingRow,{label:n("precipitation"),className:"mx-1 my-2"},(0,e.jsx)(a.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:N.snowyConfig.precipitation,defaultValue:.5,min:0,max:1,step:.1,onChange:e=>{r({snowyConfig:Object.assign(Object.assign({},N.snowyConfig),{precipitation:e})})},required:!0,"aria-label":n("precipitation")})))),(0,e.jsx)(i.SettingCollapse,{label:n("foggyDay"),role:"group","aria-label":n("foggyDay"),isOpen:w,onRequestOpen:I,onRequestClose:I,className:"my-4"},(0,e.jsx)(i.SettingRow,{label:n("fogStrength"),className:"mx-1 my-2"},(0,e.jsx)(a.NumericInput,{className:"ml-2 numeric-input",size:"sm",value:N.foggyConfig.fogStrength,defaultValue:.5,min:0,max:1,step:.1,onChange:e=>{r({foggyConfig:{fogStrength:e}})},required:!0,"aria-label":n("fogStrength")})))),(0,e.jsx)(j,{toolConfig:t.toolConfig,onAcitvedChanged:e=>{r(null,e)}}))})),b=e.React.memo((t=>{const n=e.hooks.useTranslation(o,a.defaultMessages),{onSettingChanged:l,hanldeToolSettingChanged:s}=t,r=e.React.useCallback(((e,a)=>{l(s(t.toolConfig,e,a))}),[t.toolConfig,l,s]),c=e.React.useCallback(((e,a)=>{a&&r(Object.assign(Object.assign({},t.toolConfig.config),{visType:e}))}),[r,t.toolConfig]),d=t.toolConfig.config;return(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SettingSection,{className:"first-setting-section"},(0,e.jsx)("div",{role:"group","aria-label":n("defaultAnalysisType"),className:"mb-4"},(0,e.jsx)(i.SettingRow,{label:n("defaultAnalysisType")}),(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"d-block shadow-cast-radios"},(0,e.jsx)("div",{className:"d-flex align-items-center mb-2"},(0,e.jsx)(a.Label,{className:"d-flex align-items-center"},(0,e.jsx)(a.Radio,{name:"defaultAnalysisType",className:"mr-2",checked:d.visType===u.Threshold,onChange:(e,t)=>{c(u.Threshold,t)}}),n(u.Threshold))),(0,e.jsx)("div",{className:"d-flex align-items-center mb-2"},(0,e.jsx)(a.Label,{className:"d-flex align-items-center"},(0,e.jsx)(a.Radio,{name:"defaultAnalysisType",className:"mr-2",checked:d.visType===u.Duration,onChange:(e,t)=>{c(u.Duration,t)}}),n(u.Duration))),(0,e.jsx)("div",{className:"d-flex align-items-center"},(0,e.jsx)(a.Label,{check:!0,className:"d-flex align-items-center"},(0,e.jsx)(a.Radio,{name:"defaultAnalysisType",className:"mr-2",checked:d.visType===u.Discrete,onChange:(e,t)=>{c(u.Discrete,t)}}),n("discreteShadow")))))),(0,e.jsx)(i.SettingRow,{tag:"label",label:n("timezoneSelector")},(0,e.jsx)(a.Switch,{checked:d.timezone,onChange:e=>{r({timezone:e.target.checked})}})),(0,e.jsx)(i.SettingRow,{tag:"label",label:n("dateSelector")},(0,e.jsx)(a.Switch,{checked:d.datePicker,onChange:e=>{r({datePicker:e.target.checked})}}))),(0,e.jsx)(j,{toolConfig:t.toolConfig,onAcitvedChanged:e=>{r(null,e)}}))})),I=e.React.memo((t=>{const{onSettingChanged:a,hanldeToolSettingChanged:n}=t,o=e.React.useCallback(((e,i)=>{a(n(t.toolConfig,e,i))}),[t.toolConfig,a,n]);return(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SettingSection,{className:"first-setting-section"},(0,e.jsx)(i.SettingRow,null)),(0,e.jsx)(j,{toolConfig:t.toolConfig,onAcitvedChanged:e=>{o(null,e)}}))}));var R=p(62686),N=p(48993);function M(t){return e.css`
    .panel-header {
      background:${t.ref.palette.neutral[400]};
      color:${t.ref.palette.neutral[1e3]};
      height: 50px;
      flex-shrink: 0;
      font-size: 1rem;
      font-weight: 500;
      .jimu-btn {
        color: ${t.ref.palette.neutral[1e3]} !important;
      }
      & >.actions >.jimu-btn.action-close :hover {
        color: ${t.ref.palette.black} !important;
      }
    }
  `}function k(t){return e.css`
      .popper-content {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;

        .popper-header {
          width: 100%;
          flex-shrink: 0;
          flex-grow: 0;
          cursor: move;
        }
        .map-container {
          width: 800px;
          height: 800px;
          background-color: gray;
          display: contents;
        }
        .popper-footer {
          display: flex;
          background:${t.ref.palette.neutral[400]};
          color:${t.ref.palette.neutral[1e3]};
          padding: ${e.polished.rem(10)} ${e.polished.rem(20)};

          .left-tool {
            min-height: 32px;
          }
          .right-tools{
            height: 45px;
            padding: 6px 2px;
            margin-left: auto;

            .jimu-btn {
              min-width: 80px;
            }
          }
        }
      }
  `}var P=p(5338),D=p(11526),O=p(54948),T=p(62243),A=function(e,t,a,n){return new(a||(a=Promise))((function(i,o){function l(e){try{r(n.next(e))}catch(e){o(e)}}function s(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,s)}r((n=n.apply(e,t||[])).next())}))};var z=p(28996),W=p.n(z),B=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a};const V=t=>{const a=window.SVG,{className:n}=t,i=B(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return a?e.React.createElement(a,Object.assign({className:o,src:W()},i)):e.React.createElement("svg",Object.assign({className:o},i))},L=e.React.memo((n=>{const i=(0,t.useTheme)(),l=e.hooks.useTranslation(o,a.defaultMessages),s=l("confirmInfo"),r=l("yesBtn"),c=l("commonModalCancel");return(0,e.jsx)("div",{css:e.css`
        position: absolute;
        z-index: 11;
        top: 0;
        left: 0;
        background-color: ${e.polished.rgba(i.sys.color.secondary.main,.65)};
        width: ${n.innerSize.width}px;
        height: ${n.innerSize.height}px;
        .real-container{
          background-color: ${i.sys.color.secondary.light};
          border: 1px solid ${i.sys.color.secondary.dark};
          background-clip: padding-box;
          width: 480px;
          position: relative;
          top: 50%;
          margin: -60px auto 0;
        }
        .confirm-header {
          border-bottom: 1px solid ${i.ref.palette.neutral[700]};
          padding: 16px 20px;
        }
        .confirm-context {
          padding: ${e.polished.rem(20)} ${e.polished.rem(20)} 0 ${e.polished.rem(20)};

          .title-icon {
            padding: 0 6px;
          }
          .message {
            margin-top: 1rem;
          }
        }
        .confirm-footer {
          display: flex;
          justify-content: flex-end;
          padding: ${e.polished.rem(20)};
          button {
            cursor: pointer;
            margin-left: ${e.polished.rem(8)};
            min-width: ${e.polished.rem(100)};
          }
        }
      `},(0,e.jsx)("div",{className:"real-container"},(0,e.jsx)("div",{className:"confirm-context"},(0,e.jsx)("div",{className:"message d-flex"},(0,e.jsx)("div",{className:"title-icon"},(0,e.jsx)(V,{size:"l",color:"var(--sys-color-warning-main)"})),(0,e.jsx)("div",{css:e.css`color: var(--ref-palette-neutral-1100);`,"data-testid":"confirmInfo"},s))),(0,e.jsx)("div",{className:"confirm-footer"},(0,e.jsx)(a.Button,{type:"primary",onClick:n.onConfirmWinYes},r),(0,e.jsx)(a.Button,{type:"secondary",onClick:n.onConfirmWinCancel},c))))})),E=e.React.memo((t=>{const n=e.hooks.useTranslation(o,a.defaultMessages),{jimuMapViewState:i,apiLoadedState:l,getSliceViewModel:s,isSavedFlagState:r,setIsSavedFlagState:c,resetSliceWidget:d,onPresetAnalysisChange:u,setPresetAnalysisInConfig:g,clearPresetAnalysisInConfig:m}=t,p=e.React.useCallback((()=>{let e=null;const t=s();"sliced"===t.state&&t.shape&&(e=t.shape.toJSON());let a="";e&&(a=JSON.stringify(e));const n=i.view.viewpoint.toJSON(),o={analysis:a,mapViewId:i.dataSourceId,viewpoint:n};let l;c(!0),l=e?g(o):m(),u(l)}),[i,s,c,u,g,m]),f=e.React.useCallback((()=>{c(!1),d(!1)}),[c,d]);return(0,e.jsx)("div",{className:"right-tools"},(0,e.jsx)(a.Button,{type:"primary",className:"mx-1",onClick:p,disabled:!l||!!r},n(r?"savedState":"savePopper")),(0,e.jsx)(a.Button,{type:"secondary",className:"mx-1",onClick:f,disabled:!l},n("clear")))})),F=t=>{const a=(t=>{var a;const n=document.querySelector(`iframe[name="${e.APP_FRAME_NAME_IN_BUILDER}"]`);if(n)return(null!==(a=n.contentDocument)&&void 0!==a?a:n.contentWindow.document).querySelector(t);return null})(`div.widget-renderer[data-widgetid="${t}"]`),n=document.querySelector("#default")?document.querySelector("#default").clientHeight-20:1080;let i={width:770,height:850},o={width:770,height:770};if(a){const e=a.getBoundingClientRect();let t=e.width/e.height;t=t>0?t:1;let l=1.1*e.width,s=1.1*e.height+111,r=1.1*e.width,c=1.1*e.height;l<770?(l=770,s=770/t+111,r=770,c=770/t):l>1080&&(l=1080,s=1080/t+111,r=1080,c=1080/t),s>n&&(s=n,l=(n-111)*t>770?(n-111)*t:770),c>n-111&&(c=n-111,r=(n-111)*t),i={width:l,height:s},o={width:r-2,height:c}}return{innerSize:i,innerMapSize:o}},Z=t=>{const a=(0,e.getAppStore)().getState().appStateInBuilder.appContext.isRTL;let n={x:500,y:50};const{innerSize:i}=F(t);return n={x:a?518:document.body.clientWidth-i.width-518,y:50},n},q=e.React.memo((n=>{const i=(0,t.useTheme)(),l=e.hooks.useTranslation(o,a.defaultMessages),s=e.React.useRef(null),r=e.React.useRef(null),c=e.React.useRef(null),d=e.React.useRef(null),u=e.React.useRef(null),g=e.React.useRef(null),m=e.React.useRef(null),[p,f]=e.React.useState(null),[h,S]=e.React.useState(!1),[y,x]=e.React.useState(!1),[C,j]=e.React.useState(!1),[v,w]=e.React.useState(!0),{getAnalysisFromConfig:b,setPresetAnalysisInConfig:I,clearPresetAnalysisInConfig:z,hasPresetAnalysisForThisMap:W,addAnalysesToView:B,removeAnalysesFromView:V}=(t=>{var a,n,i,o;const l=e.React.useCallback((()=>{var e;let a=null===(e=t.sliceConfig.analyses)||void 0===e?void 0:e.find((e=>{var a;return e.mapViewId===(null===(a=t.jimuMapView)||void 0===a?void 0:a.dataSourceId)}));return a||(a=null),a}),[t.sliceConfig,t.jimuMapView]),s=e.React.useCallback((()=>{let e=!1;return e=!(!t.sliceConfig.analyses||!l()),e}),[t.sliceConfig,l]),r=e.React.useCallback((()=>{var e;const t=null===(e=l())||void 0===e?void 0:e.mapViewId;return(null==t?void 0:t.startsWith("3d-toolbox-map-popper-"))?t.replace("3d-toolbox-map-popper-",""):t}),[l]),c=e.React.useCallback((()=>{var e;const t=null===(e=l())||void 0===e?void 0:e.viewpoint;return O.default.fromJSON(t)}),[l]),d=e.React.useCallback((e=>{let a=t.sliceConfig.analyses.filter((e=>e.mapViewId!==t.jimuMapView.dataSourceId));return a=a.concat(e),{analyses:a}}),[null===(a=t.jimuMapView)||void 0===a?void 0:a.dataSourceId,t.sliceConfig.analyses]),u=e.React.useCallback((()=>({analyses:t.sliceConfig.analyses.filter((e=>e.mapViewId!==t.jimuMapView.dataSourceId))})),[null===(n=t.jimuMapView)||void 0===n?void 0:n.dataSourceId,t.sliceConfig.analyses]),g=e.React.useCallback((e=>{let t=!1;return t=e===r(),t}),[r]),m=e.React.useCallback((e=>s()&&g(e)),[s,g]),p=e.React.useCallback((()=>{var e;let t=s(),a={},n=null;if(t){try{a=JSON.parse(null===(e=l())||void 0===e?void 0:e.analysis)}catch(e){t=!1,console.error(a)}const i=P.default.fromJSON(a);n=new D.default({shape:i})}return n}),[s,l]),f=e.React.useCallback(((e,a,n)=>A(void 0,void 0,void 0,(function*(){var i,o;const l=null===(i=t.jimuMapView)||void 0===i?void 0:i.view;yield T.whenOnce((()=>!l.updating));const s=n===r();if(l&&"3d"===(null==l?void 0:l.type)&&s&&e&&l.analyses.add(a),s&&e){const e=c();e&&(null===(o=t.jimuMapView)||void 0===o||o.view.goTo(e))}}))),[null===(i=t.jimuMapView)||void 0===i?void 0:i.view,r,c]),h=e.React.useCallback((e=>{var a,n;const i=null===(a=t.jimuMapView)||void 0===a?void 0:a.view;i&&e&&(null===(n=i.analyses)||void 0===n||n.remove(e),e.destroy(),e=null)}),[null===(o=t.jimuMapView)||void 0===o?void 0:o.view]);return{hasPresetAnalysisForThisMap:m,getPresetMapViewIdInConfig:r,getPresetViewpointInConfig:c,setPresetAnalysisInConfig:d,clearPresetAnalysisInConfig:u,getAnalysisFromConfig:p,addAnalysesToView:f,removeAnalysesFromView:h}})({jimuMapView:p,sliceConfig:n.toolConfig.config});e.React.useEffect((()=>{h||(0,R.loadArcGISJSAPIModules)(["esri/core/reactiveUtils","esri/widgets/Slice","esri/widgets/Slice/SliceViewModel","esri/analysis/SlicePlane","esri/analysis/SliceAnalysis"]).then((e=>{[s.current,r.current,c.current,d.current,u.current]=e,S(!0)}))}),[h,S]);const q=e.React.useRef(null),H=e.React.useRef(null),G=e.React.useCallback((()=>{(null==q?void 0:q.current)&&(null==q||q.current.remove()),(null==H?void 0:H.current)&&(null==H||H.current.remove())}),[]),$=e.React.useCallback((e=>{q.current=null==s?void 0:s.current.watch((()=>"slicing"===(null==g?void 0:g.current.viewModel.state)),(()=>{w(!1)}));let t=!0;H.current=null==s?void 0:s.current.watch((()=>"sliced"===(null==g?void 0:g.current.viewModel.state)),(()=>{let a=!1;e&&t&&(a=!0),t=!1,a||w(!1)}))}),[]),_=e.React.useCallback((e=>{G(),V(m.current),m.current=null,g.current&&g.current.destroy();const t=null==p?void 0:p.view,a={view:t,tiltEnabled:n.toolConfig.config.tiltEnabled,excludeGroundSurface:n.toolConfig.config.excludeGroundSurface},i=e&&W(null==p?void 0:p.dataSourceId);i&&(m.current=b(),a.analysis=m.current),g.current=new r.current({view:t,viewModel:new c.current(a)}),g.current.when((()=>{i?B(i,m.current,null==p?void 0:p.dataSourceId):g.current.viewModel.start(),$(i)}))}),[null==p?void 0:p.dataSourceId,null==p?void 0:p.view,n.toolConfig.config,G,$,W,b,B,V]);e.React.useEffect((()=>{p&&h&&y&&_(!0)}),[p,h,y,_]);const{onShowMapPopperChange:J}=n,Q=e.React.useCallback((()=>{v?J(!1):j(!0)}),[J,v]);e.hooks.useUnmount((()=>{G(),g.current&&g.current.destroy()}));const Y=n.useMapWidgetIds&&n.useMapWidgetIds[0],K=(0,e.getAppStore)().getState().appStateInBuilder.appConfig;if(!K.widgets[Y])return null;const U=K.widgets[Y].useDataSources,X=(0,e.Immutable)({}).set("toolConfig",{canZoom:!0,canHome:!0,canCompass:!0,canLayers:!0});return(0,e.jsx)("div",{className:"w-100"},n.isShowMapPopper&&(0,e.jsx)(a.FloatingPanel,{onHeaderClose:Q,defaultPosition:Z(n.useMapWidgetIds[0]),headerTitle:l("setDefaultSlice"),size:F(n.useMapWidgetIds[0]).innerSize,minSize:{width:770,height:850},disableResize:!0,css:M(i),className:"surface-2",disableActivateOverlay:!0,dragBounds:"body",autoFocus:!1},(0,e.jsx)("div",{className:"rounded-1 w-100 h-100",css:k},(0,e.jsx)("div",{className:"popper-content"},(0,e.jsx)("div",{className:"map-container",style:{height:"600px",width:"700px"}},(0,e.jsx)(N.JimuMap,{id:n.specifiedJimuMapId,useDataSources:U,jimuMapConfig:X,onActiveViewChange:e=>{var t;e!==p&&("3d"===(null===(t=e.view)||void 0===t?void 0:t.type)?x(!0):x(!1)),f(e)},onViewGroupCreate:e=>{}})),C&&(0,e.jsx)(L,{innerSize:F(n.useMapWidgetIds[0]).innerSize,onConfirmWinYes:()=>{J(!1)},onConfirmWinCancel:()=>{j(!1)}}),(0,e.jsx)("div",{className:"popper-footer d-flex"},(0,e.jsx)(E,{jimuMapViewState:p,apiLoadedState:h,getSliceViewModel:()=>g.current.viewModel,isSavedFlagState:v,setIsSavedFlagState:w,resetSliceWidget:_,setPresetAnalysisInConfig:I,clearPresetAnalysisInConfig:z,onPresetAnalysisChange:n.onPresetAnalysisChange}))))))}));var H=p(12046),G=p.n(H),$=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a};const _=t=>{const a=window.SVG,{className:n}=t,i=$(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return a?e.React.createElement(a,Object.assign({className:o,src:G()},i)):e.React.createElement("svg",Object.assign({className:o},i))},J=e.React.memo((t=>{const n=e.hooks.useTranslation(o,a.defaultMessages),{onSettingChanged:l,hanldeToolSettingChanged:s}=t,r=t.toolConfig.config,c=e.React.useCallback(((e,a)=>{l(s(t.toolConfig,e,a))}),[t.toolConfig,l,s]),[d,u]=e.React.useState(!1);e.hooks.useUnmount((()=>{u(!1)}));const g=e.React.useCallback((e=>{u(e)}),[]);return(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SettingSection,{className:"first-setting-section"},(0,e.jsx)(i.SettingRow,{tag:"label",label:n("tiltEnabled"),role:"group","aria-label":n("tiltEnabled")},(0,e.jsx)(a.Switch,{checked:r.tiltEnabled,onChange:e=>{c({tiltEnabled:e.target.checked})}})),(0,e.jsx)(i.SettingRow,{tag:"label",label:n("excludeGroundSurface"),role:"group","aria-label":n("excludeGroundSurface")},(0,e.jsx)(a.Switch,{checked:r.excludeGroundSurface,onChange:e=>{c({excludeGroundSurface:e.target.checked})}})),(0,e.jsx)(i.SettingRow,{label:n("defaultSlice"),role:"group","aria-label":n("defaultSlice")},(0,e.jsx)(a.Button,{type:"tertiary",icon:!0,onClick:()=>{u(!0)},"aria-label":n("defaultSlice")},(0,e.jsx)(_,null))),d&&(0,e.jsx)(q,{isShowMapPopper:d,onShowMapPopperChange:g,useDataSources:t.useDataSources,useMapWidgetIds:t.useMapWidgetIds,specifiedJimuMapId:"3d-toolbox-map-popper",toolConfig:t.toolConfig,onPresetAnalysisChange:e=>{c(e)}})),(0,e.jsx)(j,{toolConfig:t.toolConfig,onAcitvedChanged:e=>{c(null,e)}}))})),Q=e.React.memo((n=>{const l=(0,t.useTheme)(),r=e.hooks.useTranslation(o,a.defaultMessages),c=e.React.useCallback((e=>{const t=n.toolsConfig.find((t=>t.id===e));return t&&t.config?t:null}),[n.toolsConfig]),d=e.React.useCallback(((e,t,a)=>{const n=Object.assign({},e);return t&&(n.config=Object.assign(Object.assign({},n.config),t)),void 0!==a&&(n.activedOnLoad=a),n}),[]),u=n.onSettingChanged,g=e.React.useCallback(((t,a)=>{const i=n.toolsConfig.findIndex((e=>e.id===t));if(i>-1){const t=e.Immutable.setIn(n.toolsConfig,[i.toString()],a);u(t)}}),[u,n.toolsConfig]),m=r(n.shownMode?n.shownMode:"tools");return(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SidePopper,{title:m,css:C(l),isOpen:null!==n.shownMode,toggle:()=>{n.onSidePopperClose()},trigger:n.triggerFor508.current,position:"right"},(0,e.jsx)(i.SettingSection,{className:"side-popper-container"},(0,e.jsx)("div",{className:"side-popper"},n.shownMode===s.Daylight&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(v,{toolConfig:c(s.Daylight),hanldeToolSettingChanged:d,onSettingChanged:e=>{g(s.Daylight,e)}})),n.shownMode===s.Weather&&(0,e.jsx)(w,{toolConfig:c(s.Weather),hanldeToolSettingChanged:d,onSettingChanged:e=>{g(s.Weather,e)}}),n.shownMode===s.ShadowCast&&(0,e.jsx)(b,{toolConfig:c(s.ShadowCast),hanldeToolSettingChanged:d,onSettingChanged:e=>{g(s.ShadowCast,e)}}),n.shownMode===s.LineOfSight&&(0,e.jsx)(I,{toolConfig:c(s.LineOfSight),hanldeToolSettingChanged:d,onSettingChanged:e=>{g(s.LineOfSight,e)}}),n.shownMode===s.Slice&&(0,e.jsx)(J,{toolConfig:c(s.Slice),hanldeToolSettingChanged:d,onSettingChanged:e=>{g(s.Slice,e)},useMapWidgetIds:n.useMapWidgetIds,useDataSources:n.useDataSources})))))})),Y=e.React.memo((t=>{const n=e.hooks.useTranslation(o,a.defaultMessages),l=t.onChange,s=e.React.useCallback((e=>{l(Object.assign(Object.assign({},t.arrangement),{style:e}))}),[l,t.arrangement]),r=e.React.useCallback((e=>{l(Object.assign(Object.assign({},t.arrangement),{direction:e?m.Vertical:m.Horizontal}))}),[l,t.arrangement]),c=n("arrangementStyle"),d=t.widgetId+"-uimode-description",u=t.widgetId+"-uimode-0",f=t.widgetId+"-uimode-1",h=n("listMode"),S=n("iconMode");return(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(i.SettingSection,{title:c,role:"group","aria-label":c},(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"ui-mode-card-chooser"},(0,e.jsx)(a.Label,{className:"d-flex flex-column ui-mode-card-wapper"},(0,e.jsx)(a.Button,{icon:!0,className:(0,e.classNames)("ui-mode-card",{active:t.arrangement.style===g.List}),onClick:()=>{s(g.List)},title:h,"aria-label":h,"aria-labelledby":u,"aria-describedby":d},(0,e.jsx)(a.Icon,{width:92,height:56,icon:p(5739),autoFlip:!0})),(0,e.jsx)("div",{id:u,className:"mx-1 text-break ui-mode-label"},h)),(0,e.jsx)("div",{className:"ui-mode-card-separator"}),(0,e.jsx)(a.Label,{className:"d-flex flex-column ui-mode-card-wapper"},(0,e.jsx)(a.Button,{icon:!0,className:(0,e.classNames)("ui-mode-card",{active:t.arrangement.style===g.Icon}),onClick:()=>{s(g.Icon)},title:S,"aria-label":S,"aria-labelledby":f,"aria-describedby":d},(0,e.jsx)(a.Icon,{width:92,height:56,icon:p(91130),autoFlip:!0})),(0,e.jsx)("div",{id:f,className:"mx-1 text-break ui-mode-label"},S))))),t.arrangement.style===g.Icon&&(0,e.jsx)(i.SettingSection,null,(0,e.jsx)(i.SettingRow,{label:n("direction")},(0,e.jsx)(i.DirectionSelector,{"aria-label":n("direction"),vertical:t.arrangement.direction===m.Vertical,onChange:r}))))}));var K=p(31027),U=p.n(K),X=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a};const ee=t=>{const a=window.SVG,{className:n}=t,i=X(t,["className"]),o=(0,e.classNames)("jimu-icon jimu-icon-component",n);return a?e.React.createElement(a,Object.assign({className:o,src:U()},i)):e.React.createElement("svg",Object.assign({className:o},i))},te=s=>{const r=(0,t.useTheme)(),c=e.hooks.useTranslation(o,a.defaultMessages),d=e.ReactRedux.useSelector((e=>{var t,a;let n;return n=window.jimuConfig.isBuilder?e.appStateInBuilder.appConfig:e.appConfig,{appConfig:n,layoutInfo:null===(a=null===(t=null==e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.widgetsState[s.id])||void 0===a?void 0:a.layoutInfo}})),u=e.React.useMemo((()=>{var e;return(null===(e=s.useMapWidgetIds)||void 0===e?void 0:e.length)>0}),[s.useMapWidgetIds]),p={w:382,h:290},f={w:170,h:42},h={w:42,h:170},[S,y]=e.React.useState(null),C=(e,t)=>{t&&(j.current=t),y(e)},j=e.React.useRef(null);return(0,e.jsx)("div",{className:"widget-setting-directions jimu-widget-setting",css:l(r)},(0,e.jsx)(i.SettingSection,{title:c("selectMapWidget"),className:(0,e.classNames)({"border-0":!u})},(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(i.MapWidgetSelector,{onSelect:e=>{s.onSettingChange({id:s.id,useMapWidgetIds:e})},useMapWidgetIds:s.useMapWidgetIds}))),!u&&(0,e.jsx)("div",{className:"d-flex justify-content-center align-items-center placeholder-container"},(0,e.jsx)("div",{className:"text-center"},(0,e.jsx)(ee,{size:48,className:"d-inline-block placeholder-icon mb-2"}),(0,e.jsx)("p",{className:"placeholder-hint"},c("selectMapHint")))),u&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(x,{tools:s.config.tools,onToolsConfigChanged:e=>{s.onSettingChange({id:s.id,config:s.config.setIn(["tools"],e)})},onSidePopperToggle:C}),(0,e.jsx)(Y,{widgetId:s.id,arrangement:s.config.arrangement,onChange:t=>{var a,i,o,l;let r=p;const{style:c,direction:u}=t;c===g.List?r=p:c===g.Icon&&u===m.Horizontal?r=f:c===g.Icon&&u===m.Vertical&&(r=h);const S=null===(a=d.layoutInfo)||void 0===a?void 0:a.layoutId,y=null===(l=null===(o=null===(i=d.appConfig)||void 0===i?void 0:i.layouts)||void 0===o?void 0:o[S])||void 0===l?void 0:l.type;S&&y===e.LayoutType.FixedLayout&&(0,n.getAppConfigAction)().editLayoutItemSize(d.layoutInfo,r.w,r.h).exec(),c===g.Icon?(0,n.getAppConfigAction)().editWidgetProperty(s.id,"offPanel",!0).exec():(0,n.getAppConfigAction)().editWidgetProperty(s.id,"offPanel",!1).exec(),s.onSettingChange({id:s.id,config:s.config.setIn(["arrangement"],t)})}}),(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(Q,{toolsConfig:s.config.tools,shownMode:S,onSidePopperClose:()=>{C(null)},onSettingChanged:e=>{s.onSettingChange({id:s.id,config:s.config.setIn(["tools"],e)})},useMapWidgetIds:s.useMapWidgetIds,useDataSources:s.useDataSources,triggerFor508:j}))))};function ae(e){p.p=e}})(),f})())}}}));